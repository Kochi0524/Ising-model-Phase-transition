# 2 次元イジングモデルの相転移温度を深層学習から予測する

## 内容

メトロポリスモンテカルロ法を用いて作成した 2 次元イジングモデルの各サイトのスピンの様子（up or down）を画像データとして入力し、CNN を用いて学習させて強磁性 ↔ 常磁性となるときの相転移温度を予測する。

## ファイル構成

- main.f90:入力データの作成部分
- ising2d.ipynb:CNN を用いた学習部分
- modules/:main.f90 で用いるモジュール

## モデルの生成

### 二次元イジングモデル

二次元正方格子の各格子点に固定された原子模型で、スピンの値が+1(up spin)もしくは-1(down spin)のどちらかの値のみをとる。
　イジングモデルの強磁性から常磁性へと変化する相転移温度は、二次元正方格子では kT = 2.27 となることが厳密解を解くことでわかる。(結合定数 J=1 としたとき)

### Metropolis MC アルゴリズム

1. k ステップ目において、ランダムに選んだ格子点 i のスピンを反転させる。
2. スピン反転前後の隣り合う格子点との相互作用エネルギーの差を計算する。
3. エネルギーが小さくなる場合、スピンの反転を採用、大きくなる場合、p = exp(-βΔE)の確率でスピンを採用する。(β:逆温度)
4. 1 から 3 を繰り返す。

## 学習方法

### 教師あり学習

以下のようにして教師あり学習における相転移温度の予測を行った。

1. 訓練データとして、0.1 <= kT <= 2.0 (強磁性相)、2.5 <= kT <= 10.0 (常磁性相)における温度、各サイトのスピン、相のラベル(強磁性:1、常磁性:0)のデータを作成。
2. 評価データとして 1.0 <= kT <= 3.3 　におけるデータを同様に作成。
3. 訓練データの各サイトのスピンを画像データとして畳み込みニューラルネットワークを用いて学習させる。
4. 評価データをモデルに入力したときのラベルの値を図示。

学習の結果、以下のような図が得られた。評価データを用いた時のモデルの出力値は、kT = 2.27 でおおよそ 0.5 をとっており、評価データの正解率も最終エポックでは、0.996 と、うまく学習できているといえるだろう。

[ラベル画像](mag_labels.png)
